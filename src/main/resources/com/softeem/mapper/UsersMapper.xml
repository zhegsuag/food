<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.softeem.mapper.UsersMapper">
    <insert id="save" parameterType="com.softeem.domain.Users" keyProperty="id" keyColumn="id" useGeneratedKeys="true">
        insert into users(loginName, password, userName, sex, age, idCard, address, phone, email)
        values (#{loginName}, MD5(#{password}), #{userName}, #{sex}, #{age}, #{idCard}, #{address}, #{phone}, #{email})
    </insert>
    <update id="update" parameterType="com.softeem.domain.Users">
        update users
        <trim prefix="SET" suffixOverrides=",">
            <if test="loginName != null and loginName != ''" >loginName = #{loginName},</if>
            <if test="password != null and password != ''" >password =MD5(#{password}),</if>
            <if test="age != null and age != ''" >age = #{age},</if>
            <if test="userName != null and userName != ''" >userName = #{userName},</if>
            <if test="sex != null and sex != ''" >sex = #{sex},</if>
            <if test="idCard != null and idCard != ''" >idCard = #{idCard},</if>
            <if test="address != null and address != ''" >address = #{address},</if>
            <if test="email != null and email != ''" >email = #{email},</if>
            <if test="phone != null and phone !=''">phone = #{phone},</if>
        </trim>
       <where>
           <if test="email != null and email != ''" >and email = #{email}</if>
           <if test="phone != null and phone !=''">and phone = #{phone}</if>
           <if test="id != null and id != ''">and id = #{id}</if>
       </where>
    </update>
    <select id="getLogin" resultType="com.softeem.domain.Users">
        select * from users where loginName = #{loginName} and password = MD5(#{password})
    </select>

    <select id="findByLoginName" resultType="com.softeem.domain.Users">
        select * from users where loginName = #{loginName}
    </select>
    <select id="findByPhone" parameterType="string" resultType="com.softeem.domain.Users">
        select * from users where phone = #{phone}
    </select>
    <select id="findByEmail" parameterType="string" resultType="com.softeem.domain.Users">
       select * from users where  email = #{email}
    </select>


</mapper>
